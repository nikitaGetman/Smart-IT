!function(){function e(e){return r.indexOf(e)!==-1}var t,i,n=!1,a=[],r=navigator.userAgent.toLowerCase(),o=function(){n=!0;for(var e=0,t=a.length;e<t;e++)"function"==typeof a[e]&&a[e].call(this);a=null},s=function(){t.setPlugins(),t.getDUID(),setTimeout(function(){o(),o=null},10)};t=function(e,i){"string"==typeof e?t.readyForPlatform(e,i):"function"==typeof e&&t.ready(e)},i={version:.1,platformName:"",userAgent:r,createPlatform:function(t,i){var n=i.detect&&i.detect();(n||e(i.platformUserAgent))&&(this.platformName=t,_.extend(this,i),"function"==typeof i.onDetect&&this.onDetect())},ready:function(e){n?e.call(this):a.push(e)},readyForPlatform:function(e,t){var i=this;this.ready(function(){e==i.platformName&&t.call(i)})},utils:{error:function(e){$$log(e,"error")},log:{log:$.noop,state:$.noop,show:$.noop,hide:$.noop,startProfile:$.noop,stopProfile:$.noop},addExternalJS:function(e,t){function i(){o++,o===s&&t&&t.call()}var n,a,r,o=0,s=e.length;if(e.length){n=document.createDocumentFragment(),a=document.createElement("script"),a.type="text/javascript",a.onload=i;for(var l=0;l<s;l++)r=a.cloneNode(),r.src=e[l],n.appendChild(r);document.body.appendChild(n)}else t&&t.call(this)},addExternalCss:function(e){var t;e.length&&(t=document.createDocumentFragment(),_.each(e,function(e){var i=document.createElement("link");i.rel="stylesheet",i.href=e,t.appendChild(i)}),document.body.appendChild(t))},addExternalFiles:function(e){this.externalJs.length&&this.addExternalJS(this.externalJs,e),this.externalCss.length&&this.addExternalCss(this.externalCss)}}},t.config={DUID:"real"},_.extend(t,i),window.SB=t,window.onload=function(){s(),s=null}}(),!function(e,t){var i={externalCss:[],externalJs:[],keys:{},DUID:"",platformUserAgent:"not found",getDUID:function(){switch(SB.config.DUID){case"real":this.DUID=this.getNativeDUID();break;case"mac":this.DUID=this.getMac();break;case"random":this.DUID=this.getRandomDUID();break;default:this.DUID=Config.DUIDSettings}return this.DUID},getSDI:function(){return""},getRandomDUID:function(){return(new Date).getTime().toString(16)+Math.floor(Math.random()*parseInt("10000",16)).toString(16)},getMac:function(){return""},getNativeDUID:function(){return""},setPlugins:$.noop,volumeUp:$.noop,volumeDown:$.noop,getVolume:$.noop,exit:$.noop,sendReturn:$.noop,setData:function(e,t){localStorage.setItem(e,JSON.stringify(t))},getData:function(e){var t;try{t=JSON.parse(localStorage.getItem(e))}catch(e){}return t},removeData:function(e){localStorage.removeItem(e)}};_.extend(SB,i)}(this),function(e,t,i,n){function a(t){var n=e(i.createElement("div"));return n.html(t.template),n.find("."+t.elClass)}function r(){l=e(i.createElement("div")).attr("id","keyboard_overlay"),c=e(i.createElement("div")).attr({id:"keyboard_popup",class:"keyboard_popup_wrapper"}),l.append(c),e(i.body).append(l)}function o(t,i){this.$input=e(t),this.initialise(i),this.stopBlink(),this.setText(t.value)}var s,l,c,u,d="SBInput",h={keyboard:{type:"fulltext_ru",firstLayout:"ru"},formatText:null,bindKeyboard:null,input:{template:'<div class="smart_input-container"><div class="smart_input-wrap"><span class="smart_input-text"></span><span class="smart_input-cursor"></span></div></div>',elClass:"smart_input-container",wrapperClass:"smart_input-wrap",cursorClass:"smart_input-cursor",textClass:"smart_input-text"},directKeyboardInput:!1,directNumInput:!1,max:0,next:null};s={isInited:!1,_generatedKeyboard:!1,isKeyboardActive:!1,text:"",initialise:function(t){var i;return this.isInited?this:(t=e.extend({},h,t),t.next=this.$input.attr("data-next")||t.next,t.max=this.$input.attr("data-max")||t.max||0,this.options=t,this.$input.attr({"data-value":"","data-max":t.max}),i=a(t.input),i.addClass(this.$input[0].className),this.$input.hide().after(i),this.$el=i,this.$text=i.find("."+t.input.textClass),this.$cursor=i.find("."+t.input.cursorClass),this.$wrapper=i.find("."+t.input.wrapperClass),t.directKeyboardInput&&this.addDirectKeyboardEvents(),this.addEvents(),this.isInited=!0,this)},startBlink:function(){var e=this,t=this.options.input.cursorClass+"_hidden";u&&clearInterval(u),u=setInterval(function(){e.$cursor.toggleClass(t)},500)},stopBlink:function(){var e=this.options.input.cursorClass+"_hidden";u&&clearInterval(u),this.$cursor.addClass(e)},addEvents:function(){var e=this.$wrapper,t=this.options,i=this;this.$input.on({nav_focus:function(){$$nav.current(i.$el)},startBlink:function(){i.startBlink()},stopBlink:function(){i.stopBlink()},hideKeyboard:function(){e.hasClass("smart-input-active")&&i.hideKeyboard()},showKeyboard:function(){i.showKeyboard()}}),this.$el.on({nav_focus:function(){i.$input.addClass("focus")},nav_blur:function(){i.$input.removeClass("focus")}}),t.directNumInput&&!t.directKeyboardInput&&this.$el.off("nav_key:num nav_key:red").on("nav_key:num nav_key:red",function(e){i.typeNum(e)}),e.off("nav_focus nav_blur click"),t.bindKeyboard&&(t.keyboard=!1,t.bindKeyboard.off("type backspace delall").on("type",function(e){i.type(e.letter)}).on("backspace",function(){i.type("backspace")}).on("delall",function(){i.type("delall")})),t.keyboard&&this.$el.on("click",function(){i.startBlink(),i.showKeyboard()})},addDirectKeyboardEvents:function(){var t=this;this.$el.on({nav_focus:function(){t.startBlink(),e(i.body).on("keypress.SBInput",function(e){if(e.charCode)e.preventDefault(),t.type(String.fromCharCode(e.charCode));else switch(e.keyCode){case 8:e.preventDefault(),t.type("backspace")}})},nav_blur:function(){t.stopBlink(),e(i.body).off("keypress.SBInput")}})},setText:function(e){var t,i,n=this.options,a=n.max;e=e||"",e.length>a&&0!=a&&(e=e.substr(0,a)),t=n.formatText?n.formatText(e):e,this.$input.val(e).attr("data-value",e),this.text=e,this.$text.html(t),e.length>1?(i=this.$text.width()>this.$wrapper.width()?"add":"remove",this.$wrapper[i+"Class"]("."+n.input.wrapperClass+"_right")):this.$wrapper.removeClass("."+n.input.wrapperClass+"_right"),this.$input.trigger("text_change")},type:function(e){var t=this.text||"",i=this.options;switch(e){case"backspace":t=t.substr(0,t.length-1);break;case"delall":t="";break;default:t+=e}this.setText(t),t.length===i.max&&i.next&&0!=i.max&&(this.hideKeyboard(),$$nav.current(i.next),$$nav.current().click())},typeNum:function(e){switch(e.keyName){case"red":this.type("backspace");break;default:this.type(e.num)}e.stopPropagation()},changeKeyboard:function(e){var t=this.options.keyboard;this.options.keyboard=_.extend({},t,e),c&&c.SBKeyboard(this.options.keyboard)},hideKeyboard:function(e){var t=this.$wrapper;t.removeClass("smart-input-active"),this.$input.trigger("keyboard_hide"),l&&l.hide(),$$nav.restore(),$$voice.restore(),this.isKeyboardActive=!1,e?this.$input.trigger("keyboard_complete"):this.$input.trigger("keyboard_cancel"),c&&c.trigger("keyboard_hide")},showKeyboard:function(){var e=this.$wrapper,t=this.options.keyboard,i=this;this.isKeyboardActive=!0,e.addClass("smart-input-active");var n=this.$el.outerHeight(),a=this.$el.offset(),o=a.top+n;l||r(),this._generatedKeyboard||(c.SBKeyboard(t),this._generatedKeyboard=!0),c.SBKeyboard("changeKeyboard",t.type).css({left:a.left,top:o}).off("type backspace delall complete cancel").on("type",function(e){i.type(e.letter)}).on("backspace",function(){i.type("backspace")}).on("delall",function(){i.type("delall")}).on("complete cancel",function(e){var t=!1;"complete"===e.type&&(t=!0),i.stopBlink(),i.hideKeyboard(t)}),l.show();var s=c.height(),u=c.width();o+s>680&&c.css({top:o-s-n}),a.left+u>1280&&c.css({left:1280-u-20}),$$voice.save(),$$nav.save(),$$nav.on("#keyboard_popup"),c.SBKeyboard("refreshVoice").voiceLink(),this.$el.addClass($$nav.higlight_class),this.$input.trigger("keyboard_show"),this.startBlink()}},e.extend(o.prototype,s),s=null,e.fn.SBInput=function(){var t=Array.prototype.slice.call(arguments),i="string"==typeof t[0]&&t[0],n="object"==typeof t[0]&&t[0],a=t.slice(1);return this.each(function(){var t=e.data(this,"plugin_"+d);t?"function"==typeof t[i]&&t[i].apply(t,a):e.data(this,"plugin_"+d,new o(this,n))})}}(jQuery,window,document),function(e,t,i,n){function a(e,t){this.type=e.type,this.currentLayout="",this.previousLayout="",this.$el=t,this.$layouts={},this.presets=[],this.initialize(e)}function r(t,i){this.$el=e(t),this.keyboards={},i=e.extend({},l,i),this.addKeyboard(i),this.$el.addClass("keyboard_popup_wrapper")}var o="SBKeyboard",s=/([^{]+){{([^}]*)}}/,l={type:"en",firstLayout:null},c={},u={},d={};u={isShiftActive:!1,isNumsShown:!1,currentPresetType:"",initialize:function(t){var n,a,r=_.result(this,"type"),o="",s=!1;if(n=SB.keyboardPresets[r],!n)throw new Error("Preset "+r+" doesn't exist");this.currentPresetType=r,this.$wrap=e(i.createElement("div")).addClass("kb-wrap"),"function"==typeof n?(this.presets.push(r),o=this.generateBoard(r)):n.length&&(this.presets=n,s=n.indexOf("fullnum")!==-1,s&&(this.presets=_.without(this.presets,"fullnum")),o=this.generateFull(this.presets,s)),this.$wrap.append(o).addClass("kekekey_"+r),this.$el.append(this.$wrap),this.setEvents();for(var l=0;l<this.presets.length;l++)a=this.presets[l],this.$layouts[a]=this.$wrap.find(".keyboard_generated_"+a);s&&(this.$layouts.fullnum=this.$wrap.find(".keyboard_generated_fullnum")),this.presets.indexOf(t.firstLayout)!==-1?this.changeLayout(t.firstLayout):this.changeLayout(this.presets[0])},generateFull:function(e,t){var i="",n="";e.length>1&&this.$wrap.addClass("kb-multilang");for(var a=0;a<e.length;a++)n=e[a],i+=this.generateBoard(n);return t&&(this.$wrap.addClass("kb-havenums"),i+=this.generateBoard("fullnum")),i},generateBoard:function(e){var t,i,n=SB.keyboardPresets[e],a="",r="",o={};if(d[e])return d[e].board;n=n(),a='<div class="kb-c keyboard_generated_'+e+'">';for(var l=0;l<n.length;l++){t=n[l],r='<div class="kb-row" data-nav_type="hbox">';for(var c=0;c<t.length;c++){if(i=t[c],1==i.length||"&amp;"===i)o={text:i,type:"",letter:i};else{var u=s.exec(i);o.text=u[2]||"",o.type=u[1],o.letter=""}r+='<div class="kbtn nav-item '+o.type+'" data-letter="'+_.escape(o.letter)+'"',o.type&&(r+=' data-keytype="'+o.type+'"'),r+=">"+o.text+"</div>"}a+=r+"</div>"}return a+="</div>",d[e]={board:a},a},onKeyNum:function(t){switch(t.keyName){case"red":this.$el.trigger("backspace");break;default:var i=e.Event({type:"type"});i.letter=""+t.num,this.$el.trigger(i)}t.stopPropagation()},defaultOnKey:function(e){e.stopPropagation()},onKeyDown:function(t){var i,n=e(t.currentTarget),a=n.attr("data-keytype"),r=n.attr("data-letter");if(i=e.Event({type:"type"}),a)switch(a){case"backspace":i="backspace";break;case"delall":i="delall";break;case"complete":i="complete";break;case"space":i.letter=" ";break;case"shift":return void this.triggerShiftLetters();case"lang":return void this.changeKeyboardLang();case"nums":return void this.triggerNumKeyboard()}else i.letter=this.isShiftActive?r.toUpperCase():r;i&&this.$el.trigger(i),t.stopPropagation()},triggerShiftLetters:function(){this.isShiftActive?(this.isShiftActive=!1,this.$el.removeClass("shift_active")):(this.isShiftActive=!0,this.$el.addClass("shift_active"))},triggerNumKeyboard:function(){this.isNumsShown?(this.isNumsShown=!1,this.changeLayout(this.previousLayout),this.$el.trigger("hide_num")):(this.isNumsShown=!0,this.changeLayout("fullnum"),this.$el.trigger("show_num")),$$nav.current(this.$layouts[this.currentLayout].find(".nums"))},changeKeyboardLang:function(){var e,t=this.presets.indexOf(this.currentLayout);e=(t+1)%this.presets.length,this.changeLayout(this.presets[e]),$$nav.current(this.$layouts[this.currentLayout].find(".lang"))},changeLayout:function(e){var t,i=this.$layouts[e];this.currentLayout&&(t=this.$layouts[this.currentLayout],t&&t.hide(),this.$el.removeClass("keyboard_"+this.currentLayout),this.previousLayout=this.currentLayout),i&&(this.currentLayout=e,this.$el.addClass("keyboard_"+e),i.show())},setEvents:function(){var e=this;this.$wrap.on("nav_key:yellow nav_key:blue",this.defaultOnKey),this.$wrap.on("nav_key:num nav_key:red",_.bind(this.onKeyNum,this)),this.$wrap.on("click",".kbtn",_.bind(this.onKeyDown,this)),this.$wrap.on("nav_key:green",function(t){e.$el.trigger("complete"),t.stopPropagation()}).on("nav_key:return",function(t){e.$el.trigger("cancel"),t.stopPropagation()})},show:function(){return this.$wrap.show(),this.$el.addClass(_.result(this,"type")+"_wrap").addClass("keyboard_"+this.currentLayout),this},hide:function(){this.$wrap.hide(),this.$el.removeClass(_.result(this,"type")+"_wrap").removeClass("keyboard_"+this.currentLayout)}},e.extend(a.prototype,u),u=null,c={addKeyboard:function(t){var i=e.extend({},l,t),n=_.isFunction(t.type)?_.result(t,"type"):t.type;this.keyboards[n]||(this.keyboards[n]=new a(i,this.$el)),this.changeKeyboard(n)},changeKeyboard:function(e){var t,i,n=this.currentKeyboard;e=_.isFunction(e)?e():e,t=this.keyboards[e],i=n&&n.currentPresetType===e,t&&!i?(n&&n.hide(),this.currentKeyboard=t.show()):t||this.addKeyboard({type:e})}},e.extend(r.prototype,c),c=null,e.fn.SBKeyboard=function(){var t=Array.prototype.slice.call(arguments),i="string"==typeof t[0]&&t[0],n="object"==typeof t[0]&&t[0],a=t.slice(1);return this.each(function(){var t=e.data(this,"plugin_"+o);t?i?t[i]&&t[i].apply(t,a):n&&t.addKeyboard(n):e.data(this,"plugin_"+o,new r(this,n))})}}(jQuery,window,document),window.SB=window.SB||{},window.SB.keyboardPresets={en:function(){return["qwertyuiop".split(""),"asdfghjkl".split("").concat(['backspace{{<i class="backspace_icon"></i>}}']),['shift{{<i class="shift_icon"></i>Shift}}'].concat("zxcvbnm".split("")).concat(["delall{{<span>Del<br/>all</span>}}"]),["lang{{en}}","nums{{123}}","space{{}}","complete{{Complete}}"]]},ru:function(){return["йцукенгшщзхъ".split(""),"фывапролджэ".split("").concat(['backspace{{<i class="backspace_icon"></i>}}']),['shift{{<i class="shift_icon"></i>Shift}}'].concat("ячсмитьбю".split("")).concat(["delall{{<span>Del<br/>all</span>}}"]),["lang{{ru}}","nums{{123}}","space{{}}","complete{{Готово}}"]]},email:function(){return["1234567890@".split(""),"qwertyuiop".split("").concat(['backspace{{<i class="backspace_icon"></i>}}']),"asdfghjkl_".split("").concat(["delall{{<span>Del<br/>all</span>}}"]),"zxcvbnm-.".split("").concat("complete{{OK}}")]},num:function(){return["123".split(""),"456".split(""),"789".split(""),['backspace{{<i class="backspace_icon"></i>}}',"0","complete{{OK}}"]]},fullnum:function(){return["1234567890".split(""),'-/:;()$"'.split("").concat(["&amp;",'backspace{{<i class="backspace_icon"></i>}}']),["nums{{ABC}}"].concat("@.,?!'+".split("")),["space{{}}","complete{{OK}}"]]},fulltext_ru:["ru","en"],fulltext_en:["en"],fulltext_ru_nums:["ru","en","fullnum"],fulltext_en_nums:["en","fullnum"]},function(e){"use strict";function t(e){return s.indexOf(e)===-1}function i(e){var i=t(e)?" legend-clickable":"";return'<div class="legend-item legend-item-'+e+i+'" data-key="'+e+'"><i class="leg-icon leg-icon-'+e+'"></i><span class="legend-item-title"></span></div>'}function n(){for(var e,t,n="",a=0,r=o.length;a<r;a++)n+=i(o[a]);return e=document.createElement("div"),t=document.createElement("div"),e.className="legend",e.id="legend",t.className="legend-wrap",t.innerHTML=n,e.appendChild(t),$(e)}var a,r,o=["info","red","green","yellow","blue","rew","play","pause","stop","ff","tools","left","right","up","down","leftright","updown","move","number","enter","ret"],s=["leftright","left","right","up","down","updown","move","number"],l=[];r=function(){var e=this;this.$el=n(),this.keys={};for(var t=function(t){var i;e.keys[t]||(i=e.$el.find(".legend-item-"+t),e.keys[t]=new a(i))},c=0;c<o.length;c++)t(o[c]);this.addKey=function(e,n){var a;"undefined"==typeof n&&(n=!0),n||s.push(e),a=i(e),this.$el.find(".legend-wrap").append(a),t(e)},this.show=function(){this.$el.show()},this.hide=function(){this.$el.hide()},this.clear=function(){for(var e in this.keys)this.keys[e]("")},this.save=function(){for(var e in this.keys)l[e]=this.keys[e]()},this.restore=function(){_.each(o,function(e){r[e](l[e])});for(var e in l)this.keys[e](l[e]);l=[]}},a=function(e){return this.$el=e,this.$text=e.find(".legend-item-title"),_.bind(this.setText,this)},a.prototype.text="",a.prototype.isShown=!1,a.prototype.setText=function(e){return"undefined"==typeof e?this.text:void(e!==this.text&&(e=e||"",!e&&this.isShown?(this.$el[0].style.display="none",this.$el.removeClass("legend-item-visible"),this.isShown=!1):e&&!this.isShown&&(this.$el[0].style.display="",this.$el.addClass("legend-item-visible"),this.isShown=!0),this.text=e,this.$text.html(e)))},e.$$legend=new r,$(function(){$$legend.$el.appendTo(document.body),$$legend.$el.on("click",".legend-clickable",function(){var e,t,i=$(this).attr("data-key");"ret"===i?i="return":"rew"===i&&(i="rw"),e=$.Event("nav_key:"+i),t=$.Event("nav_key"),t.keyName=e.keyName=i,$$nav.current().trigger(e).trigger(t)})})}(this),function(e,t){var i,n,a,r,o={},s={},l=[],c=0,u=20;i=$("<div></div>",{id:"log"}),$(function(){i.appendTo(document.body)}),n=$("<div></div>",{class:"log-row"}),r=function(e){this.name=e,this.logs=0,this.states={};var t=i.find("#log_"+this.name);this.$content=t.find(".log_content"),this.$state=t.find(".log_states"),t=null},_.extend(r.prototype,{log:function(e){var t,i,a=n.clone();this.logs++,e=_.escape(e),a.html(e).appendTo(this.$content),this.logs>u&&(t=this.$content.find(".log-row"),i=t.length,t.slice(0,i-u).remove(),this.logs=t.length)},state:function e(t,i){var e=this.states[i]||this.createState(i);e.textContent=i+": "+t},createState:function(e){var t=document.createElement("div");return t.id="#log_"+this.name+"_"+e,this.states[e]=t,this.$state.append(t),t}});var d='<div class="log_pane" id="log_<%=name%>"><div class="log_name">Log: <%=name%></div><div class="log_content_wrap"><div class="log_content"></div></div><div class="log_states"></div></div>';a={create:function(e){var t=d.replace(/<%=name%>/g,e);return i.append(t),s[e]=new r(e),l.push(e),s[e]},getPanel:function(e){return e=e||"default",s[e]||this.create(e)}},e.SB.utils.log={log:function(e,t){a.getPanel(t).log(e)},state:function(e,t,i){a.getPanel(i).state(e,t)},show:function(e){e=e||l[c],e?(c++,i.show(),$(".log_pane").hide(),$("#log_"+e).show()):(c=0,this.hide())},hide:function(){i.hide()},startProfile:function(e){e&&(o[e]=(new Date).getTime())},stopProfile:function(e){o[e]&&(this.log(e+": "+((new Date).getTime()-o[e])+"ms","profiler"),delete o[e])}},e.$$log=SB.utils.log.log,e.$$error=SB.utils.error}(this),$(function(){var e=SB.config.logKey||"tools";$(document.body).on("nav_key:"+e,function(){SB.utils.log.show()})}),!function(e,t){function i(){function e(e){var t,n={},a=e.keyCode;!f&&u&&(t=r[a],t&&(h.indexOf(t)>-1?o(t):(d.indexOf(t)>-1&&(n.num=t[1],t="num"),i(t,n))))}function i(e,t){var i,n;u&&(i=$.Event("nav_key:"+e,t||{}),n=$.Event("nav_key"),i.keyName=e,n.keyName=e,u.trigger(i),u&&u.trigger(n))}function o(e){var t=c[e];t||(t=c[e]=_.throttle(function(){i(e)},800,{leading:!0})),t(e)}function s(){u&&u.click()}var l=[],c={},u=null,d=["n0","n1","n2","n3","n4","n5","n6","n7","n8","n9"],h=["green","red","yellow","blue"],f=0;return{area_selector:".nav-item",higlight_class:"focus",$container:null,loopType:null,phantom_selector:"[data-nav-phantom]",isPaused:function(){return!!f},pause:function(){return f++,this},resume:function(e){return f--,(f<0||e)&&(f=0),this},save:function(){return l.push({navCur:u,area_selector:this.area_selector,higlight_class:this.higlight_class,$container:this.$container}),this},restore:function(){if(l.length){this.off();var e=l.pop();this.area_selector=e.area_selector,this.higlight_class=e.higlight_class,this.on(e.$container,e.navCur)}return this},current:function(e,t){if(!e)return u;t=t||"nav_key";var i=$(e);if(i.is(this.phantom_selector)&&(i=$($(i.attr("data-nav-phantom"))[0])),i.length>1)throw new Error("Focused element must be only one!");if(!i.length)return this;var n=u;return u&&u.removeClass(this.higlight_class).trigger("nav_blur",[t,i]),u=i,i.addClass(this.higlight_class).trigger("nav_focus",[t,n]),this},on:function(t,i){var n,r=this;return a=a||$(document.body),this.off(),this.$container=t?$(t):a,"philips"!=SB.platform&&this.$container.on("mouseenter.nav",this.area_selector,function(e){$(this).is(r.phantom_selector)||r.current(this,"mouseenter")}),n=this.$container.find("[data-nav_type]"),this.$container.attr("data-nav_type")&&(n=n.add(this.$container)),n.each(function(){var e=$(this),t=e.attr("data-nav_type");e.removeAttr("data-nav_type");var i=e.attr("data-nav_loop");r.siblingsTypeNav(e,t,i)}),a.bind("keydown.navigation",e).bind("nav_key:enter.navigation",s),i||(i=this.$container.find(this.area_selector).filter(":visible")[0]),this.current(i),this},siblingsTypeNav:function(e,t,i){var a=this;e.on("nav_key:left nav_key:right nav_key:up nav_key:down",this.area_selector,function(r){var o,s,l="last",c=a.current();if("hbox"==t&&"left"==r.keyName||"vbox"==t&&"up"==r.keyName?s="prev":("hbox"==t&&"right"==r.keyName||"vbox"==t&&"down"==r.keyName)&&(s="next"),"next"==s&&(l="first"),s){for(o=c[s](a.area_selector);o.length&&!o.is(":visible");)o=o[s](a.area_selector);if(!o.length&&i&&(o=e.find(a.area_selector).filter(":visible")[l]()),o.length)return n.current(o),!1}})},off:function(){return u&&u.removeClass(this.higlight_class).trigger("nav_blur"),this.$container&&this.$container.off("mouseenter.nav").off(".loop"),a.unbind(".navigation"),u=null,this},findSome:function(){var e;return u&&u.is(":visible")||(e=this.$container.find(this.area_selector).filter(":visible").eq(0),this.current(e)),this},findNav:function(e,t,i){function n(e,t,i){var n=null;switch(i){case"left":case"right":if(e.top>t.top&&(n=t,t=e,e=n),e.bottom>t.top)return e.top>t.right?t.top-e.right:t.height;break;case"up":case"down":if(e.left>t.left&&(n=t,t=e,e=n),e.right>t.left)return e.left>t.right?t.left-e.right:t.width}return!1}var a=this.checkUserDefined(e,t);if(a)return"none"!==a&&a;var r,o,s,l,c=e[0].getBoundingClientRect(),u=[],d=null;for(s=0,l=i.length;s<l;s++)if(d=i[s].getBoundingClientRect(),d.left!=c.left||d.top!=c.top){switch(t){case"left":r=c.left>d.left;break;case"right":r=c.right<d.right;break;case"up":r=c.top>d.top;break;case"down":r=c.bottom<d.bottom}r&&u.push({obj:i[s],bounds:d})}var h=9999999,f=9999999,p=9999999,g=0,v=0,y=0,m=0,b=!1,_=!1;for(s=0,l=u.length;s<l;s++)if(this.checkEntryPoint(u[s].obj,t)){var $=u[s].bounds,P=n(c,$,t);if(v=Math.abs($.top-c.top),y=Math.abs($.left-c.left),m=Math.sqrt(v*v+y*y),!b||P)if(!P||b){switch(t){case"left":case"right":o=b?y<f||y==f&&v<h:v<h||v==h&&y<f;break;case"up":case"down":o=b?v<h||v==h&&y<f:y<f||y==f&&v<h}o&&(h=v,f=y,p=m,_=u[s].obj)}else h=v,f=y,g=P,_=u[s].obj,b=!0}return _},checkUserDefined:function(e,t){var i=e.data("nav_ud"),n=!1,a=e.data("nav_ud_"+t);if(!i&&!a)return!1;if(!a){var r=i.split(","),o=["up","right","down","left"];if(4!==r.length)return!1;e.data({nav_ud_up:r[0],nav_ud_right:r[1],nav_ud_down:r[2],nav_ud_left:r[3]}),a=r[o.indexOf(t)]}return"none"==a?n="none":"0"==a?n=!1:a&&(n=$(a).first()),n},checkEntryPoint:function(e,i){var n=$(e),a=n.attr("data-nav_ep"),r=null;if(!a)return!0;if(r=n.attr("data-nav_ep_"+i),r===t){var o=a.split(",");n.attr("data-nav_ep_top",o[0]),n.attr("data-nav_ep_right",o[1]),n.attr("data-nav_ep_bottom",o[2]),n.attr("data-nav_ep_left",o[3]),r=n.attr("data-nav_ep_"+i)}return!!parseInt(r)}}}var n,a=null,r={};SB.ready(function(){var e=SB.keys;for(var t in e)r[e[t]]=t.toLowerCase()}),n=e.$$nav=new i,$(function(){$(document.body).bind("nav_key:left nav_key:right nav_key:up nav_key:down",function(e){var t,i,a=n.current();t=n.$container.find(n.area_selector).filter(":visible"),i=n.findNav(a,e.keyName,t),i&&n.current(i)})})}(this),function(e){var t,i,n,a=0,r=function(e){e.state="play",t=setInterval(function(){e.trigger("update"),e.videoInfo.currentTime+=.5,e.videoInfo.currentTime>=e.videoInfo.duration&&(e.stop(),e.trigger("complete"))},500)},o=!1,s=e.Player={_init:function(){},state:"stop",play:function(e){o||(this._init(),o=!0),"string"==typeof e&&(e={url:e}),void 0!==e?(this.stop(),this.state="play",this._play(e)):void 0===e&&"pause"===this.state&&this.resume()},_play:function(){var e=this;setTimeout(function(){e.trigger("ready"),setTimeout(function(){e.trigger("bufferingBegin"),setTimeout(function(){e.videoInfo.currentTime=0,e.trigger("bufferingEnd"),r(e)},1e3)},1e3)},1e3)},stop:function(e){"stop"!=this.state&&(this._stop(),e||this.trigger("stop")),this.state="stop"},pause:function(){this._stop(),this.state="pause"},resume:function(){r(this)},togglePause:function(){"play"==this.state?this.pause():this.resume()},_stop:function(){clearInterval(t)},formatTime:function(e){var t=Math.floor(e/3600),i=e%3600,n=Math.floor(i/60),a=i%60,e=Math.ceil(a);return e<10&&(e="0"+e),n<10&&(n="0"+n),(t?t+":":"")+n+":"+e},videoInfo:{duration:0,width:0,height:0,currentTime:0},seek:function(e){var t=this;t.videoInfo.currentTime=e,t.pause(),t.trigger("bufferingBegin"),setTimeout(function(){t.trigger("bufferingEnd"),t.resume()},500)},audio:{set:function(e){a=e},get:function(){for(var e=2,t=[],i=0;i<e;i++)t.push(0);return t},cur:function(){return a},toggle:function(){var e=this.get().length,t=this.cur();e>1&&(t++,t>=e&&(t=0),this.set(t))}},subtitle:{set:function(e){curSubtitle=e},get:function(){for(var e=2,t=[],i=0;i<e;i++)t.push(0);return t},cur:function(){return curSubtitle},toggle:function(){var e=s.subtitle.get().length,t=s.subtitle.cur();e>1&&(t++,t>=e&&(t=0),s.subtitle.set(t))},text:function(e){var t=s.subtitle.data,i=_.sortedIndex(t,{time:e},function(e){return e.time});return t[i-1]?t[i-1].text:""},data:[{time:0,text:""}],url:function(e){var t=/\.([^\.]+)$/.exec(e)[1];s.subtitle.set(void 0),$.ajax({url:e,dataType:"text",success:function(e){var i=$("#subtitles_view");$(s).off(".subtitles"),s.subtitle.init=!0,s.subtitle.remote=!0,s.subtitle.parse[t].call(s,e),i.show();var n=function(){$("#subtitles_text").html(s.subtitle.text(1e3*parseInt(s.videoInfo.currentTime)))};s.on("update",n),i.length||($("body").append('<div id="subtitles_view" style="position: absolute; z-index: 1;"><div id="subtitles_text"></div></div>'),i=$("#subtitles_view"),i.css({width:"1280px",height:"720px",left:"0px",top:"0px"}),$("#subtitles_text").css({position:"absolute","text-align":"center",width:"100%",left:"0",bottom:"50px","font-size":"24px",color:"#fff","text-shadow":"0 0 3px #000,0 0 3px #000,0 0 3px #000,0 0 3px #000,0 0 3px #000,0 0 3px #000,0 0 3px #000,0 0 3px #000,0 0 3px #000","line-height":"26px"}));var a=function(){$(s).off("update",n),$(s).off("stop",a),i.hide()};s.on("stop",a)}})},parse:{smi:function(e){e=e.split(/\s*<sync/i),e.shift(),s.subtitle.data=_.map(e,function(e){var t=/[\s\S]*start=(\d+)[\s\S]*<p[^>]*>([\s\S]*)<spanid/i.exec(e);if(t)return{time:parseInt(t[1],10),text:t[2]}})},srt:function(e){e=e.split("\r\n\r\n");var t=s.subtitle;t.data=[];var i=function(e){var t=e.match(/(\d{2}):(\d{2}):(\d{2}),(\d+)/);return 36e5*parseInt(t[1],10)+6e4*parseInt(t[2],10)+1e3*parseInt(t[3],10)+parseInt(t[4],10)};_.each(e,function(e){if(e){var n,a,r=e.split("\n"),o=r[1].split(" --> ");r.splice(0,2),n=i(o[0]),a=i(o[1]),t.data.push({time:n,text:r.join("<br/>")}),t.data.push({time:a,text:""})}}),t.data.unshift({time:0,text:""})}}}};e._&&_.extend?i=_.extend:e.$&&$.extend&&(i=$.extend),e.EventEmitter?n=EventEmitter.prototype:e.Backbone?n=Backbone.Events:e.Events&&(n=Events.prototype),s.extend=function(e){i(this,e)},s.extend(n)}(this),function(e){"use strict";function t(t){var i=[];return t.each(function(){var t=e(this),n=t.attr("data-voice"),a=t.attr("data-voice-group"),r="true"===t.attr("data-voice-hidden"),o=t.attr("data-voice-weight")||0,s=!1;return n?void(t.attr("data-voice-disabled")||(o||(a||r?o=f.candidateWeight:(o=f.helpbarItemWeight,s=!0)),i.push({itemText:n,weight:o,group:a,hidden:r,main:s}),p[n.toLowerCase()]=t)):void console.error("command in ",this," is not defined")}),i}var i,n,a,r,o,s=!1,l=!1,c=[],u=e("<div/>"),d=!1,h=function(){if(!s){if(l=$$voice._nativeCheckSupport(),!l)return;$$voice._init(),r=e("#voice_buble"),s=!0}},f={selector:".voicelink",moreText:"More",eventName:"voice",useHidden:!1,helpText:"",showHelperTimes:3,helpbarMaxItems:6,sortByWeight:!0,helpbarItemWeight:200,candidateWeight:0};window.$$voice={voiceTimeout:1e4,_resetVisibilityTimeout:function(){$$voice.helpbarVisible=!0,clearTimeout(o),o=setTimeout(function(){"function"==typeof voiceServer&&(voiceServer=!1,$$voice.restore()),r.hide(),$$voice.helpbarVisible=!1},this.voiceTimeout)},_init:function(){},_nativeCheckSupport:function(){},helpbarVisible:!1,enabled:function(){return h(),l},_setVoiceHelp:function(e){},pause:function(){d=!0},resume:function(){d=!1},say:function(t){if(!d){var i=t.toLowerCase(),r=e.extend({},f,n);p[i]&&p[i].trigger(r.eventName),a&&m.call(a,n)}},_nativeTurnOff:function(){},hide:function(){if(this.enabled())return this._nativeTurnOff(),r.hide(),this},setup:function(t){return e.extend(f,t),this},save:function(){return i&&c.push(i),this},restore:function(){var t=c.pop();return t&&e.fn.voiceLink.apply(t.self,t.args),this},_nativeFromServer:function(e,t){},fromServer:function(e,t){return s?(this.save(),this._nativeFromServer(e,t),this):this},refresh:function(){return this.save().restore()}};var p,g=!1,v={},y=0,m=function(i){if(!g){g=!0,r.hide().empty();var n,a,o,s,l,c=[],d=[],h=e.extend({},f,i),m=h.helpbarMaxItems,b=this.find(h.selector),$={helpbarType:"HELPBAR_TYPE_VOICE_CUSTOMIZE",bKeepCurrentInfo:"false",helpbarItemsList:{}};if(p={},!i.useHidden){var P=b.filter("[data-voice-force-visible]");b=b.filter(":visible").add(P)}n=h.sortByWeight?_.sortBy(t(b),function(e){return-e.weight}):t(b),l=e.grep(n,function(e){return e.hidden===!0}),s=_.difference(n,l),s.length>m&&(s.splice(m-1,0,{itemText:h.moreText,commandList:[{command:h.moreText}]}),u.unbind().bind(h.eventName,function(){e("body").trigger("showVoiceHelpbar"),$$voice._resetVisibilityTimeout(),r.show()}),p[h.moreText.toLowerCase()]=u),a=s.splice(0,m),o=_.union(l,s),_.each(a,function(e){var t=e.itemText;c.push({itemText:t,commandList:[{command:t}]})}),_.each(o,function(e){var t=e.group,i=e.itemText,n=e.hidden,a=e.main;if(a&&!t&&(t=""),!n){v[t]||(y++,v[t]=y);var o=r.find("#voice_group_body_"+v[t]);o.length?o.append('<div class="voice_help_item">'+i+"</div>"):r.append('<div class="voice_group_head">'+t+'</div><div class="voice_group_body" id="voice_group_body_'+v[t]+'"><div class="voice_help_item">'+i+"</div></div>")}d.push({candidate:e.itemText})}),$.helpbarItemsList=c,d.length&&($.candidateList=d),$$voice._setVoiceHelp($)}};e.fn.voiceLink=function(e){s&&!l||(h(),i={self:this,args:arguments},g=!1,e||(e={}),n=e,a=this,$$voice.helpbarVisible&&m.call(this,n))}}(jQuery),SB.readyForPlatform("browser",function(){Player.extend({_init:function(){var e=this,t=1280,i=720;this.$video_container=$('<video id="smart_player" style="position: absolute; left: 0; top: 0;width: '+t+"px; height: "+i+'px;"></video>');var n=this.$video_container[0];$("body").append(this.$video_container),this.$video_container.on("loadedmetadata",function(){e.videoInfo.width=n.videoWidth,e.videoInfo.height=n.videoHeight,e.videoInfo.duration=n.duration,e.trigger("ready")}),this.$video_container.on("loadstart",function(t){e.trigger("bufferingBegin")}).on("playing",function(){e.trigger("bufferingEnd")}).on("timeupdate",function(){e.videoInfo.currentTime=n.currentTime,e.trigger("update")}).on("ended",function(){e.state="stop",e.trigger("complete")}),this.$video_container.on("abort canplay canplaythrough canplaythrough durationchange emptied ended error loadeddata loadedmetadata loadstart mozaudioavailable pause play playing ratechange seeked seeking suspend volumechange waiting",function(e){})},_play:function(e){this.$video_container.attr("src",e.url),this.$video_container[0].play()},_stop:function(){this.$video_container[0].pause(),this.$video_container[0].src=""},pause:function(){this.$video_container[0].pause(),this.state="pause"},resume:function(){this.$video_container[0].play(),this.state="play"},seek:function(e){this.$video_container[0].currentTime=e},audio:{set:function(e){},get:function(){return[]},cur:function(){return 0}},subtitle:{set:function(e){if(Player.$video_container[0].textTracks){var t=_.filter(Player.$video_container[0].textTracks,function(e){
return"subtitles"===e.kind});if(t.length)return _.each(t,function(t,i){"showing"===t.mode?t.mode="disabled":i==e&&(t.mode="showing")}),!0}return!1},get:function(){if(Player.$video_container[0].textTracks){var e=_.filter(Player.$video_container[0].textTracks,function(e){return"subtitles"===e.kind});if(e.length)return _.map(e,function(t){return{index:e.indexOf(t),language:t.language}})}return!1},cur:function(){var e=-1;if(Player.$video_container[0].textTracks){var t=_.filter(Player.$video_container[0].textTracks,function(e){return"subtitles"===e.kind});t.length&&_.each(t,function(t,i){if("showing"===t.mode)return e=i,!1})}return e},toggle:function(){var e=Player.subtitle.get().length,t=Player.subtitle.cur();e>1&&(t++,t>=e&&(t=-1),Player.subtitle.set(t))}}})}),SB.createPlatform("browser",{keys:{RIGHT:39,LEFT:37,DOWN:40,UP:38,RETURN:27,EXIT:46,TOOLS:32,FF:33,RW:34,NEXT:107,PREV:109,ENTER:13,RED:65,GREEN:66,YELLOW:67,BLUE:68,CH_UP:221,CH_DOWN:219,N0:48,N1:49,N2:50,N3:51,N4:52,N5:53,N6:54,N7:55,N8:56,N9:57,PRECH:45,SMART:36,PLAY:97,STOP:98,PAUSE:99,SUBT:76,INFO:73,REC:82},detect:function(){return!0},getNativeDUID:function(){return navigator.userAgent.indexOf("Chrome")!=-1?this.DUID="CHROMEISFINETOO":this.DUID="FIREFOXISBEST",this.DUID}}),function(e){"use strict";SB.readyForPlatform("browser",function(){_.extend($$voice,{_init:function(){this.helpbarVisible=!0,e("body").append('<div id="voice_buble"></div><div id="help_voice_bubble"></div><div class="emul_voice_helpbar_wrap"><div id="emul_voice_helpbar"></div></div>'),e("#emul_voice_helpbar").on("click",".emul_voice_trigger",function(){$$voice.say(this.innerHTML)})},_nativeTurnOff:function(){e("#emul_voice_helpbar").empty()},_nativeFromServer:function(e,t){var i=prompt(e);t(i||"")},_nativeCheckSupport:function(){return!0},_setVoiceHelp:function(t){var i=e("#emul_voice_helpbar");i.empty(),t.helpbarItemsList&&e.each(t.helpbarItemsList,function(t,n){e("<div>",{attr:{class:"emul_voice_trigger main"},html:n.itemText,appendTo:i})}),t.candidateList&&e.each(t.candidateList,function(t,n){e("<div>",{attr:{class:"emul_voice_trigger"},html:n.candidate,appendTo:i})})}})})}(jQuery),SB.readyForPlatform("lg",function(){var e,t=!1;Player.extend({updateDelay:500,_init:function(){var e=this;$("body").append('<object type="video/mp4" data="" width="1280" height="720" id="pluginPlayer" style="z-index: 0; position: absolute; left: 0; top: 0;"></object>'),this.plugin=$("#pluginPlayer")[0],this.$plugin=$(this.plugin),this.plugin.onPlayStateChange=function(){e.onEvent.apply(e,arguments)},this.plugin.onBuffering=function(){e.onBuffering.apply(e,arguments)}},onEvent:function(){"5"==this.plugin.playState&&(this.state="stop",this.trigger("complete"))},_update:function(){var e=this.plugin.mediaPlayInfo();e&&!t&&(t=!0,this.trigger("ready"),this.videoInfo={duration:e.duration/1e3}),this.videoInfo.currentTime=e.currentPosition/1e3,this.trigger("update")},onBuffering:function(e){this.trigger(e?"bufferingBegin":"bufferingEnd")},_play:function(i){clearInterval(e),e=setInterval(function(){Player._update()},this.updateDelay),t=!1,this.plugin.data=i.url,this.plugin.play(1)},pause:function(){this.plugin.play(0),this.state="pause"},resume:function(){this.plugin.play(1),this.state="play"},_stop:function(){this.plugin.stop(),this.state="stop"},seek:function(e){this.plugin.seek(1e3*e)}})}),SB.createPlatform("lg",{platformUserAgent:"netcast",keys:{ENTER:13,PAUSE:19,LEFT:37,UP:38,RIGHT:39,DOWN:40,N0:48,N1:49,N2:50,N3:51,N4:52,N5:53,N6:54,N7:55,N8:56,N9:57,RED:403,GREEN:404,YELLOW:405,BLUE:406,RW:412,STOP:413,PLAY:415,FF:417,RETURN:461,CH_UP:33,CH_DOWN:34},getNativeDUID:function(){return this.device.serialNumber},getMac:function(){return this.device.net_macAddress.replace(/:/g,"")},getSDI:$.noop,setPlugins:function(){$("body").append('<object type="application/x-netcast-info" id="device" width="0" height="0"></object>'),this.device=$("#device")[0],this.modelCode=this.device.version,this.productCode=this.device.platform,this.getDUID(),setInterval(function(){var e;window.NetCastGetUsedMemorySize&&(e=window.NetCastGetUsedMemorySize())},5e3),Player&&Player.setPlugin&&Player.setPlugin()},sendReturn:function(){Player&&Player.stop(!0),window.NetCastBack()},exit:function(){Player&&Player.stop(!0),window.NetCastExit()},getUsedMemory:function(){return window.NetCastGetUsedMemorySize()},getChildlockPin:function(){return 1234}}),SB.readyForPlatform("mag",function(){var updateInterval,startUpdate=function(){updateInterval=setInterval(function(){var e=stb.GetPosTime();Player.videoInfo.currentTime=e,Player.trigger("update"),SB.utils.log.state(e,"position","player")},500)},stopUpdate=function(){clearInterval(updateInterval)};window.stbEvent={onEvent:function(data){if(data+="","1"==data)Player.trigger("complete");else if("2"==data)Player.videoInfo.duration=stb.GetMediaLen()+1,Player.videoInfo.currentTime=0,Player.trigger("ready");else if("4"==data)Player.trigger("bufferingEnd");else if("7"==data){var vi=eval(stb.GetVideoInfo());Player.videoInfo.width=vi.pictureWidth,Player.videoInfo.height=vi.pictureHeight}},event:0};var stb=window.gSTB;Player.extend({_init:function(){stb.InitPlayer(),stb.SetViewport(1280,720,0,0),stb.SetTopWin(0)},_play:function(e){stb.Play(e.url),startUpdate(),Player.trigger("bufferingBegin")},_stop:function(){stb.Stop(),stopUpdate()},pause:function(){stb.Pause(),this.state="pause",stopUpdate()},resume:function(){stb.Continue(),this.state="play",startUpdate()},seek:function(e){stb.SetPosTime(e)},audio:{set:function(e){stb.SetAudioPID(e)},get:function(){return stb.GetAudioPIDs()},cur:function(){return stb.GetAudioPID()}},subtitle:{set:function(e){stb.SetSubtitlePID(e)},get:function(){var e=[];return _.each(stb.GetSubtitlePIDs(),function(t){e.push({index:t.pid,language:t.lang[1]})}),e},cur:function(){return stb.GetSubtitlePID()}}})}),function(){var e;SB.createPlatform("mag",{keys:{RIGHT:39,LEFT:37,DOWN:40,UP:38,RETURN:8,EXIT:27,TOOLS:122,FF:70,RW:66,NEXT:34,PREV:33,ENTER:13,RED:112,GREEN:113,YELLOW:114,BLUE:115,CH_UP:9,CH_DOWN:9,N0:48,N1:49,N2:50,N3:51,N4:52,N5:53,N6:54,N7:55,N8:56,N9:57,PRECH:116,POWER:85,PLAY:82,STOP:83,INFO:89},onDetect:function(){var t=!1;e=window.gSTB,e.EnableVKButton(!1),window.moveTo(0,0),window.resizeTo(1280,720),SB(function(){var i=$(document.body);i.on("nav_key:power",function(){var n="standby_";t=!t,n+=t?"set":"unset",e.StandBy(t),$$log("trigger standby event "+n,"standby"),i.trigger(n)})}),window.localStorage={setItem:function(t,i){"object"==typeof i&&(i=JSON.stringify(i)),e.SaveUserData(t,i)},clear:function(){},getItem:function(t){return e.LoadUserData(t)},removeItem:function(t){e.SaveUserData(t,null)}}},detect:function(){return!!window.gSTB},exit:function(){$$log("try to location change"),Player.stop(!0),gSTB.DeinitPlayer(),window.location="file:///home/web/services.html"},sendReturn:function(){this.exit()},getMac:function(){return e.GetDeviceMacAddress()},getNativeDUID:function(){return e.GetDeviceSerialNumber()}})}(),SB.readyForPlatform("philips",function(){function e(){switch(t.playTime>1&&(n||(Player.videoInfo.duration=t.playTime/1e3+1,Player.trigger("ready"),n=!0)),t.playState){case 5:Player.trigger("complete"),r(),Player.state="stop";break;case 0:Player.state="stop";break;case 6:Player.trigger("error");break;case 1:Player.trigger("bufferingEnd"),a();break;case 2:case 3:case 4:Player.trigger("bufferingBegin"),r()}}var t,i,n=!1,a=function(){var e=0;i=setInterval(function(){t.playPosition!=e&&(Player.videoInfo.currentTime=t.playPosition/1e3,Player.trigger("update")),e=t.playPosition},500)},r=function(){clearInterval(i)};Player.extend({_init:function(){$("body").append('<div id="mediaobject" style="position:absolute;left:0px;top:0px;width:640px;height:480px;">\n              <object id="videoPhilips" type="video/mpeg4" width="1280" height="720" />\n               </div>'),t=document.getElementById("videoPhilips"),t.onPlayStateChange=e},_play:function(e){t.data=e.url,t.play(1),n=!1,Player.trigger("bufferingBegin")},_stop:function(){t.stop(),r()},pause:function(){t.play(0),this.state="pause",r()},resume:function(){t.play(1),this.state="play",a()},seek:function(e){t.seek(1e3*(e-10))}})}),SB.createPlatform("philips",{platformUserAgent:"nettv",setPlugins:function(){this.keys={ENTER:VK_ENTER,PAUSE:VK_PAUSE,LEFT:VK_LEFT,UP:VK_UP,RIGHT:VK_RIGHT,DOWN:VK_DOWN,N0:VK_0,N1:VK_1,N2:VK_2,N3:VK_3,N4:VK_4,N5:VK_5,N6:VK_6,N7:VK_7,N8:VK_8,N9:VK_9,RED:VK_RED,GREEN:VK_GREEN,YELLOW:VK_YELLOW,BLUE:VK_BLUE,RW:VK_REWIND,STOP:VK_STOP,PLAY:VK_PLAY,FF:VK_FAST_FWD,RETURN:VK_BACK,CH_UP:VK_PAGE_UP,CH_DOWN:VK_PAGE_DOWN}}}),function(){var e,t,i,n,a=window.localStorage;if(_.isFunction(window.FileSystem)){if(e=new FileSystem,t=e.isValidCommonPath(curWidget.id),t||e.createCommonDir(curWidget.id),i=curWidget.id+"_localStorage.db",n=e.openCommonFile(i,"r+"))try{JSON.parse(n.readAll())}catch(e){a&&a.clear()}else n=e.openCommonFile(i,"w"),n.writeAll("{}");if(e.closeCommonFile(n),!a){var r={},o=!1,s=_.debounce(function(){o&&(n=e.openCommonFile(i,"w"),n.writeAll(JSON.stringify(window.localStorage)),e.closeCommonFile(n),o=!1)},100);r.setItem=function(e,t){return o=!0,this[e]=t,s(),this[e]},r.getItem=function(e){return this[e]},r.removeItem=function(e){delete this[e],s()},r.clear=function(){var e=this;for(var t in e)"function"!=typeof e[t]&&delete e[t];s()},window.localStorage=r}}}(),SB.readyForPlatform("samsung",function(){var e=0,t=0,i=function(e,t,i){try{switch(i.length){case 0:return e[t]();case 1:return e[t](i[0]);case 2:return e[t](i[0],i[1]);case 3:return e[t](i[0],i[1],i[2]);case 4:return e[t](i[0],i[1],i[2],i[3]);case 5:return e[t](i[0],i[1],i[2],i[3],i[4]);case 6:return e[t](i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return e[t](i[0],i[1],i[2],i[3],i[4],i[5],i[6]);case 8:return e[t](i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7])}}catch(e){throw e}};Player.extend({usePlayerObject:!0,_init:function(){var e=this;if(e.usePlayerObject?(e.plugin=document.getElementById("pluginPlayer"),$("body").append(e.$plugin)):e.plugin=sf.core.sefplugin("Player"),!e.plugin)throw new Error("failed to set plugin");e.plugin.OnStreamInfoReady="Player.OnStreamInfoReady",e.plugin.OnRenderingComplete="Player.OnRenderingComplete",e.plugin.OnCurrentPlayTime="Player.OnCurrentPlayTime",e.plugin.OnCurrentPlaybackTime="Player.OnCurrentPlayTime",e.plugin.OnBufferingStart="Player.OnBufferingStart",e.plugin.OnBufferingComplete="Player.OnBufferingComplete",e.plugin.OnEvent="Player.onEvent"},seek:function(e){e<=0&&(e=0);var t=Math.floor(e-this.videoInfo.currentTime-1);this.videoInfo.currentTime=e,alert("jump: "+t),t<0?this.doPlugin("JumpBackward",-t):this.doPlugin("JumpForward",t)},onEvent:function(e,t,i){switch(e){case 9:this.OnStreamInfoReady();break;case 4:break;case 8:this.OnRenderingComplete();break;case 14:this.OnCurrentPlayTime(t);break;case 13:break;case 12:this.OnBufferingComplete();break;case 11:this.OnBufferingStart()}},OnRenderingComplete:function(){alert("PLAYER COMPLETE"),Player.trigger("complete")},OnStreamInfoReady:function(){var e,t,i,n;try{e=this.doPlugin("GetDuration")}catch(e){alert("######## "+e.message)}if(e=Math.ceil(e/1e3),this.usePlayerObject)t=this.doPlugin("GetVideoWidth"),i=this.doPlugin("GetVideoHeight");else if(n=this.doPlugin("GetVideoResolution"),n==-1)t=0,i=0;else{var a=n.split("|");t=a[0],i=a[1]}this.videoInfo.duration=e,this.videoInfo.width=1*t,this.videoInfo.height=1*i,this.trigger("ready")},OnBufferingStart:function(){this.trigger("bufferingBegin")},OnBufferingComplete:function(){this.trigger("bufferingEnd")},OnCurrentPlayTime:function(e){"play"==this.state&&(alert(e/1e3),this.videoInfo.currentTime=e/1e3,this.trigger("update"))},_play:function(e){var t=e.url;switch(e.type){case"hls":t+="|COMPONENT=HLS"}this.doPlugin("InitPlayer",t),this.doPlugin("StartPlayback",e.from||0)},_stop:function(){this.doPlugin("Stop")},pause:function(){this.doPlugin("Pause"),this.state="pause"},resume:function(){this.doPlugin("Resume"),this.state="play"},doPlugin:function(){var e,t=this.plugin,n=arguments[0],a=Array.prototype.slice.call(arguments,1,arguments.length)||[];return this.usePlayerObject?e=i(t,n,a):(n.indexOf("Buffer")!=-1&&(n+="Size"),a.unshift(n),e=i(t,"Execute",a)),e},audio:{set:function(t){Player.doPlugin("SetStreamID",1,t),e=t},get:function(){for(var e=Player.doPlugin("GetTotalNumOfStreamID",1),t=[],i=0;i<e;i++)t.push(Player.doPlugin("GetStreamLanguageInfo",1,i));return t},cur:function(){return e}},subtitle:{set:function(e){Player.doPlugin("SetStreamID",5,e),t=e},get:function(){for(var e=Player.doPlugin("GetTotalNumOfStreamID",5),t=[],i=0;i<e;i++)t.push(Player.doPlugin("GetStreamLanguageInfo",5,i));return t},cur:function(){return t}}})}),!function(e,t){var i=e.document,n={audio:"SAMSUNG-INFOLINK-AUDIO",pluginObjectTV:"SAMSUNG-INFOLINK-TV",pluginObjectTVMW:"SAMSUNG-INFOLINK-TVMW",pluginObjectNetwork:"SAMSUNG-INFOLINK-NETWORK",pluginObjectNNavi:"SAMSUNG-INFOLINK-NNAVI",pluginPlayer:"SAMSUNG-INFOLINK-PLAYER"},a=["$MANAGER_WIDGET/Common/af/../webapi/1.0/deviceapis.js","$MANAGER_WIDGET/Common/af/../webapi/1.0/serviceapis.js","$MANAGER_WIDGET/Common/af/2.0.0/extlib/jquery.tmpl.js","$MANAGER_WIDGET/Common/Define.js","$MANAGER_WIDGET/Common/af/2.0.0/sf.min.js","$MANAGER_WIDGET/Common/API/Plugin.js","$MANAGER_WIDGET/Common/API/Widget.js","$MANAGER_WIDGET/Common/API/TVKeyValue.js","src/platforms/samsung/localstorage.js"];SB.createPlatform("samsung",{$plugins:{},platformUserAgent:"maple",onDetect:function(){for(var e="",t=0;t<a.length;t++)e+='<script type="text/javascript" src="'+a[t]+'"></script>';for(var r in n)e+="<object id="+r+' border=0 classid="clsid:'+n[r]+'" style="opacity:0.0;background-color:#000000;width:0px;height:0px;"></object>';i.write(e)},getNativeDUID:function(){return this.$plugins.pluginObjectNNavi.GetDUID(this.getMac())},getMac:function(){return this.$plugins.pluginObjectNetwork.GetMAC()},getSDI:function(){return this.SDI=this.$plugins.SDIPlugin.Execute("GetSDI_ID"),this.SDI},getHardwareVersion:function(){var e=this.firmware.match(/\d{4}/)||[];return"2013"===e[0]?this.hardwareVersion=sf.core.sefplugin("Device").Execute("Firmware"):this.hardwareVersion=null,this.hardwareVersion},setPlugins:function(){function e(e){try{a.pluginAPI.unregistKey(t["KEY_"+e])}catch(e){$$error(e)}}var t,a=this,r=2;_.each(n,function(e,t){a.$plugins[t]=i.getElementById(t)}),this.$plugins.SDIPlugin=sf.core.sefplugin("ExternalWidgetInterface"),this.$plugins.tvKey=new Common.API.TVKeyValue;var o=this.$plugins.pluginObjectNNavi,s=this.$plugins.pluginObjectTV;this.modelCode=o.GetModelCode(),this.firmware=o.GetFirmware(),this.systemVersion=o.GetSystemVersion(0),this.productCode=s.GetProductCode(1),this.pluginAPI=new Common.API.Plugin,this.widgetAPI=new Common.API.Widget,t=new Common.API.TVKeyValue,this.productType=s.GetProductType(),this.setKeys(),this.pluginAPI.SetBannerState&&o.SetBannerState(r),e("VOL_UP"),e("VOL_DOWN"),e("MUTE"),this.widgetAPI.sendReadyEvent()},setKeys:function(){this.keys=sf.key,i.body.onkeydown=function(e){var t=e.keyCode;switch($$log("keyDown "+t),t){case sf.key.RETURN:case 147:case 261:sf.key.preventDefault()}}},enableScreenSaver:function(e){e=e||!1,sf.service.setScreenSaver(!0,e)},disableScreenSaver:function(){sf.service.setScreenSaver(!1)},exit:function(){sf.core.exit(!1)},sendReturn:function(){sf.core.exit(!0)},blockNavigation:function(){sf.key.preventDefault()}})}(this),function(e){"use strict";SB.readyForPlatform("samsung",function(){var t,i=function(e){switch(e.eventtype){case"EVENT_VOICE_END_MONITOR":break;case"EVENT_VOICE_BEGIN_MONITOR":case"EVENT_VOICE_BTSOUND_START":$$voice.refresh(),$$voice._resetVisibilityTimeout();break;case"EVENT_VOICE_RECOG_RESULT":var i=e.result.toLowerCase();"function"!=typeof t?$$voice.say(i):(t(i),t=!1,$$voice.restore())}};_.extend($$voice,{_init:function(){deviceapis.recognition.SubscribeExEvent(deviceapis.recognition.PL_RECOGNITION_TYPE_VOICE,"Smartbox",function(e){i(e)}),deviceapis.recognition.SetVoiceTimeout(this.voiceTimeout),e("body").append('<div id="voice_buble"></div><div id="help_voice_bubble"></div>')},_nativeCheckSupport:function(){var e=!1;try{e=deviceapis.recognition.IsRecognitionSupported()}catch(e){}return e},_nativeFromServer:function(e,i){t=i;var n={helpbarType:"HELPBAR_TYPE_VOICE_SERVER_GUIDE_RETURN",guideText:e};deviceapis.recognition.SetVoiceHelpbarInfo(JSON.stringify(n))},_setVoiceHelp:function(e){deviceapis.recognition.SetVoiceHelpbarInfo(JSON.stringify(e))},_nativeTurnOff:function(){deviceapis.recognition.SetVoiceHelpbarInfo(JSON.stringify({helpbarType:"HELPBAR_TYPE_VOICE_CUSTOMIZE",bKeepCurrentInfo:"false",helpbarItemsList:[]}))}})})}(jQuery),function(){"use strict";window.addEventListener("storage",function(e){console.log("Storage is change")}),window.App={currentScene:null,scenes:{},config:{},isShown:!0,isPlayerInited:!1,initialize:function(){console.log("Initialization"),App.config.init(),this.$wrap=$(".wrap"),this.$player=$(".player"),this.$player.hide(),$$legend.show(),this.setEvents(),$$nav.on()},setEvents:function(){var e=this;$(".menu-navigation").on("click",".nav-item",function(t){var i=t.currentTarget.getAttribute("data-content");e.showContent(i)}),$(document.body).on({"nav_key:blue":_.bind(this.toggleView,this),"nav_key:stop":function(){Player.stop()},"nav_key:pause":function(){console.log("nav_key:pause"),Player.togglePause()},"nav_key:exit":function(){SB.exit()}}),Player.on("ready",function(){$$log("player ready"),console.log("player ready"),e.isPlayerInited=!0,e.toggleView()}),Player.on("stop",function(){$$log("player stop"),console.log("player stop")}),Player.on("bufferingBegin",function(){}),$(".nav-item:eq(0)").click()},toggleView:function(){console.log("Toggling + "+this.isPlayerInited),this.isPlayerInited&&(this.isShown?(this.$wrap.hide(),$$legend.hide(),this.$player.show(),$$nav.save(),$$nav.on(this.$player)):(Player.pause(),this.$player.hide(),this.$wrap.show(),$$legend.show(),$$nav.restore()),this.isShown=!this.isShown)},showContent:function(e){var t=this.currentScene,i=this.scenes[e];t!==i&&(i?(t&&t.hide(),i.show(),this.currentScene=i):(console.log("Scene "+e+" doesn`t exist"),$$error("Scene "+e+" doesn't exist")))}},SB.ready(_.bind(App.initialize,App))}(),function(){"use strict";window.App.config={availiblePlaylists:[],checkedPlaylists:[],availibleParameters:[],checkedParameters:[],storage:[],init:function(){App.config.storage.storageAvailable("localStorage"),$.ajaxSetup({dataFilter:function(e,t){var i=JSON.parse(e);return i.error?(console.log("Respinse error "+i.error.code+": "+i.error.text),$$error("Respinse error "+i.error.code+": "+i.error.text),!1):i.response.result},error:function(e,t,i){console.log(t),$$error(t)}}),this.getAllParameters(),this.getCheckedPlaylists(),this.getSearchParameters()},getAllParameters:function(){var e=this;$.ajax({url:"api/application.getAllParameters",async:!1,success:function(t){return!!t&&(e.availiblePlaylists=t.playlists,void(e.availibleParameters=t.parameters))}})},getCheckedPlaylists:function(){if(this.storage.isAvailible){var e=localStorage.getItem("checked_playlists");null!=e&&"[]"!=e||(e='["'+this.availiblePlaylists[0]+'"]');for(var t=JSON.parse(e),i=0;i<t.length;i++){var n=this.availiblePlaylists.indexOf(t[i]);n<0&&t.splice(i,1)}this.checkedPlaylists=t}},getSearchParameters:function(){if(this.storage.isAvailible){var e=localStorage.getItem("search_parameters");null!=e&&"[]"!=e||(e='{"languages" : ["en", "ru"]}');for(var t=JSON.parse(e),i=0;i<t.length;i++){var n=this.availibleParameters.indexOf(t[i]);if(n<0)delete t[i];else for(var a=0;a<t[i].length;a++)n=this.availibleParameters[t[i]].indexOf(t[i][a]),n<0&&t[i].splice(a,1)}this.checkedParameters=t}},setCheckedPlaylists:function(e){if(this.storage.isAvailible)if(_.difference(this.checkedPlaylists,e).length>0||_.difference(e,this.checkedPlaylists).length>0){var t=JSON.stringify(e);localStorage.setItem("checked_playlists",t),this.checkedPlaylists=e;var i=new Event("playlist_change");window.dispatchEvent(i)}else console.log("setCheckedPlaylists: Nothing is change")},setSearchParameters:function(e){var t=!1;for(var i in e)if(_.difference(this.checkedParameters[i],e[i]).length>0||_.difference(e[i],this.checkedParameters[i]).length>0){t=!0;break}if(this.storage.isAvailible)if(t){e==[]&&(e={languages:["en"]});var n=JSON.stringify(e);localStorage.setItem("search_parameters",n),this.checkedParameters=e;var a=new Event("parameters_change");window.dispatchEvent(a)}else console.log("setCheckedParameters: Nothing is change")}},window.App.config.storage={isAvailible:!1,storageAvailable:function(e){try{var t=window[e],i="__storage_test__";return t.setItem(i,i),t.removeItem(i),this.isAvailible=!0,!0}catch(e){return this.isAvailible=!1,!1}}}}(),$(function(){"use strict";var e=$(document.body),t=window.$$legend.keys;$(".nav-item").on({nav_focus:function(){t.enter("Show content")},nav_blur:function(){t.enter("")}}),e.on("nav_focus",".input-item",function(){t.enter("Show keyboard"),t.number("Num input")}),e.on("nav_blur",".input-item",function(){t.enter(""),t.number("")}),e.on("nav_focus","#keyboard_popup",function(){t.enter("Input"),t.number("Num input"),t.red("Remove symbol"),t.green("Complete"),t.ret("Hide keyboard")}),e.on("nav_blur","#keyboard_popup",function(){t.enter(""),t.number(""),t.red(""),t.green(""),t.ret("")}),e.on("nav_focus",".nav-item",function(){t.move("Navigate")}),e.on("nav_blur",".nav-item",function(){t.move("")}),e.on("nav_focus",".video-item",function(){t.enter("Play video")}),e.on("nav_blur",".video-item",function(){t.enter("")})}),function(){"use strict";var e,t=_.template('<div class="col-md-3" data-nav_type="vbox">                   <div class="block nav-item video-item" data-url="<%=link%>" data-type="<%=type%>">                    <%=title%>                  </div>                </div>'),i=_.template('<div class="nav-item playlist-item" data-content="<%=value%>"><%=value%></div>');window.App.scenes.playlist={currentVideo:null,playlists:{},currentPlaylist:null,offset:0,init:function(){this.$el=$(".scene-playlist");var t=this;this.$el.on("click",".video-item",function(e){var i=e.currentTarget.getAttribute("data-url"),n=e.currentTarget.getAttribute("data-type");t.onItemClick(i,n)}),this.$el.on("click",".playlist-item",function(e){var i=e.currentTarget.getAttribute("data-content");t.onMenuClick(i)}),this.getPlaylists(),this.renderPlylists(),this.$el.find(".playlist-item:eq(0)").click(),window.addEventListener("playlist_change",function(e){console.log("Playlist change event"),t.getPlaylists(),t.currentPlaylist=t.playlists[0].value,t.renderPlylists(),t.updateItems()}),window.addEventListener("parameters_change",function(e){t.offset=0,t.updateItems()}),e=!0},show:function(){e||this.init(),this.$el.show()},hide:function(){this.$el.hide()},onItemClick:function(e,t){null!==e&&(this.currentVideo!==e?(console.log("OnItemClick url = "+e),Player.play({url:e,type:t}),this.currentVideo=e):App.toggleView())},onMenuClick:function(e){var t=this.currentPlaylist;console.log("Current = "+t+", new = "+e),t!==e&&null!==e&&(this.currentPlaylist=e,this.offset=0,this.updateItems())},getPlaylists:function(){for(var e=App.config.checkedPlaylists,t=[],i=0;i<e.length;i++)t[i]={value:e[i]};this.playlists=t},renderPlylists:function(){for(var e=this.playlists,t="",n=0;n<e.length;n++)t+=i(e[n]);this.$el.find(".menu-items").empty().html(t)},updateItems:function(){var e=JSON.stringify(App.config.checkedParameters);$.ajax({url:"api/application.getByCategory",type:"POST",data:{parameters:e,category:this.currentPlaylist,offset:this.offset},success:this.renderItems,context:this})},renderItems:function(e){var i="";if(e.length>0)for(var n=0,a=e.length;n<a;n++)i+=t(e[n]),this.offset++;else i='<div class="text-center">Ничего не найдено</div>';this.$el.find(".row").empty().html(i)}}}(),function(){"use strict";var t;window.App.scenes.settings={currentModule:null,init:function(){console.log("Init scene settings"),this.$el=$(".scene-settings");for(var e=this,i=this.$el.find(".module-categories").find(".box"),n=App.config.availiblePlaylists,a=App.config.checkedPlaylists,r="",o=0;o<n.length;o++){var s=a.indexOf(n[o]);r+='<p class="nav-item input-item '+(s<0?"":"checked")+'" data-content="'+n[o]+'">'+n[o]+"</p>"}i.empty().html(r);var i=this.$el.find(".module-search_parameters").find(".box"),l=App.config.availibleParameters,c=App.config.checkedParameters,r="",u=0;for(var d in l){r+='<div data-content="'+d+'"><h2>'+d+":</h2>";for(var h=0;h<l[d].length;h++){var s;s=c[d].length>=h?c[d].indexOf(l[d][h]):-1,r+='<p class="nav-item input-item '+(s<0?"":"checked")+'" data-content="'+l[d][h]+'">'+l[d][h]+"</p>"}r+="</div>",u++}console.log("html: "+r),i.empty().html(r),this.$el.on("click",".leftbar-item",function(t){var i=t.currentTarget.getAttribute("data-content");e.onMenuClick(i)}),this.$el.find(".module").hide(),this.$el.find(".leftbar-item:eq(0)").click(),this.$el.find(".input-item").on("click",function(e){$(this).toggleClass("checked")}),t=!0},onMenuClick:function(t){var i=this.currentModule;i!==t&&(t?(i&&($(".module-"+i).hide(),this.save()),$(".module-"+t).show(),this.currentModule=t):(console.log("Module "+e+" doesn`t exist"),$$error("Scene "+e+" doesn't exist")))},save:function(){if("categories"==this.currentModule){for(var e=$(".module-"+this.currentModule).find(".box").children(".checked"),t=[],i=0;i<e.length;i++)t[i]=e[i].getAttribute("data-content");App.config.setCheckedPlaylists(t)}if("search_parameters"==this.currentModule){for(var e=$(".module-"+this.currentModule).find(".box").children(),n={},i=0;i<e.length;i++){for(var a=e.children(".checked"),t=[],r=0;r<a.length;r++)t[r]=a[r].getAttribute("data-content");n[e[i].getAttribute("data-content")]=t}App.config.setSearchParameters(n)}},show:function(){t||this.init(),this.$el.show()},hide:function(){this.save(),this.$el.hide()}}}(),$(function(){function e(){u||l.show(),u=!0,c<=0&&setTimeout(i,1e3),c=7}function t(){u&&l.hide(),u=!1}function i(){u&&(c--,c<=0?t():setTimeout(i,1e3))}var n=$(".progress"),a=$(".progress-bar"),r=$(".current-time"),o=$(".button_play_pause"),s=$(".duration"),l=$(".player"),c=0,u=!1,d=!1;$(document).mousemove(function(t){d&&t.pageY>620&&e()}),Player.on("update",function(){if(u||d){var e=Player.videoInfo.currentTime;a.css({width:e/Player.videoInfo.duration*100+"%"}),r.html(Player.formatTime(e))}}),Player.on("ready",function(){r.html(Player.formatTime(0)),s.html(Player.formatTime(Player.videoInfo.duration)),d=!0,o.find(".fa").removeClass("fa-play"),o.find(".fa").addClass("fa-pause")}),Player.on("stop",function(){r.html(Player.formatTime(0)),s.html(Player.formatTime(0)),a.css({width:"0%"})}),Player.on("complete",function(){Player.seek(0),a.css({width:0}),o.find(".fa").removeClass("fa-pause"),o.find(".fa").addClass("fa-play"),e()});var h=n.offset().left,f=n.width();n.click(function(t){var i=t.pageX-h;Player.seek(Player.videoInfo.duration*(i/f)),e()}),o.click(function(){Player.togglePause(),"pause"===Player.state?(o.find(".fa").addClass("fa-play"),o.find(".fa").removeClass("fa-pause")):"play"===Player.state&&(o.find(".fa").addClass("fa-pause"),o.find(".fa").removeClass("fa-play")),e()}),$(".button_rw").click(function(){e(),Player.seek(Player.videoInfo.currentTime-10)}),$(".button_ff").click(function(){e(),Player.seek(Player.videoInfo.currentTime+10)}),$(".button_compress").click(function(){d=!1,o.find(".fa").removeClass("fa-pause"),o.find(".fa").addClass("fa-play"),App.toggleView()}),$(".btn").on("nav_focus",function(){d=!0,e()}),$("body").on("nav_key",function(){console.log("$('body').on('nav_key'"),d&&e()})});